<Window x:Class="KdxDesigner.Views.MemorySettingWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:KdxDesigner.Views" xmlns:utils="clr-namespace:KdxDesigner.Utils"
        mc:Ignorable="d"
        Title="ãƒ¡ãƒ¢ãƒªè¨­å®š" Height="700" Width="900"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <utils:BoolToColorConverter x:Key="BoolToColorConverter"/>

        <Style TargetType="TextBox">
            <Setter Property="Margin" Value="5,2"/>
            <Setter Property="Padding" Value="3"/>
        </Style>
        <Style TargetType="CheckBox">
            <Setter Property="Margin" Value="10,2"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
        <Style TargetType="TextBlock">
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="5,2"/>
        </Style>


    </Window.Resources>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠžã‚¨ãƒªã‚¢ -->
        <GroupBox Header="ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠž" Grid.Row="0" Padding="10" Margin="0,0,0,10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- PLCç”¨ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠž (å·¦åˆ—) -->
                <Border Grid.Column="0" BorderBrush="#2196F3" BorderThickness="2" Padding="10" Margin="0,0,5,0" CornerRadius="5">
                    <StackPanel>
                        <TextBlock Text="PLCç”¨ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«" FontWeight="Bold" FontSize="14" Foreground="#2196F3" Margin="0,0,0,10"/>
                        <TextBlock Text="Cylinder/Error/Timer/å·¥ç¨‹æ™‚é–“ãƒ‡ãƒã‚¤ã‚¹è¨­å®š" FontSize="10" Foreground="Gray" Margin="0,0,0,5"/>
                        <TextBlock Text="â€»PLCå…¨ä½“ã«1å›žã®ã¿é©ç”¨" FontSize="10" FontStyle="Italic" Foreground="DarkOrange" Margin="0,0,0,10"/>

                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«:" Width="90" VerticalAlignment="Center" Margin="0,0,5,0"/>
                            <ComboBox ItemsSource="{Binding PlcProfiles}"
                                     SelectedItem="{Binding SelectedPlcProfile}"
                                     DisplayMemberPath="Name"
                                     Width="250" Margin="0,0,0,5">
                                <ComboBox.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem Header="ç·¨é›†" Command="{Binding EditPlcProfileCommand}">
                                            <MenuItem.Icon>
                                                <TextBlock Text="âœï¸" FontSize="14"/>
                                            </MenuItem.Icon>
                                        </MenuItem>
                                        <MenuItem Header="å‰Šé™¤" Command="{Binding DeletePlcProfileCommand}">
                                            <MenuItem.Icon>
                                                <TextBlock Text="ðŸ—‘ï¸" FontSize="14"/>
                                            </MenuItem.Icon>
                                        </MenuItem>
                                    </ContextMenu>
                                </ComboBox.ContextMenu>
                            </ComboBox>
                        </StackPanel>

                        <Button Content="æ–°è¦PLCç”¨ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ" Command="{Binding CreateNewPlcProfileCommand}"
                                Width="200" Margin="0,10,0,0" Padding="5"
                                Background="#2196F3" Foreground="White" FontSize="11"/>
                    </StackPanel>
                </Border>

                <!-- Cycleç”¨ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«é¸æŠž (å³åˆ—) -->
                <Border Grid.Column="1" BorderBrush="#4CAF50" BorderThickness="2" Padding="10" Margin="5,0,0,0" CornerRadius="5">
                    <StackPanel>
                        <TextBlock Text="Cycleç”¨ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«" FontWeight="Bold" FontSize="14" Foreground="#4CAF50" Margin="0,0,0,10"/>
                        <TextBlock Text="Process/ProcessDetail/Operationãƒ‡ãƒã‚¤ã‚¹è¨­å®š" FontSize="10" Foreground="Gray" Margin="0,0,0,5"/>
                        <TextBlock Text="â€»Cycleã”ã¨ã«è¤‡æ•°é¸æŠžå¯èƒ½" FontSize="10" FontStyle="Italic" Foreground="DarkOrange" Margin="0,0,0,10"/>

                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«:" Width="90" VerticalAlignment="Top" Margin="0,5,5,0"/>
                            <ListBox ItemsSource="{Binding CycleProfiles}"
                                     x:Name="CycleProfileListBox"
                                     SelectionMode="Multiple"
                                     DisplayMemberPath="Name"
                                     Width="250" Height="100" Margin="0,0,0,5"
                                     SelectionChanged="ProfileListBox_SelectionChanged">
                                <ListBox.ContextMenu>
                                    <ContextMenu>
                                        <MenuItem Header="ç·¨é›†" Command="{Binding EditCycleProfileCommand}">
                                            <MenuItem.Icon>
                                                <TextBlock Text="âœï¸" FontSize="14"/>
                                            </MenuItem.Icon>
                                        </MenuItem>
                                        <MenuItem Header="å‰Šé™¤" Command="{Binding DeleteCycleProfileCommand}">
                                            <MenuItem.Icon>
                                                <TextBlock Text="ðŸ—‘ï¸" FontSize="14"/>
                                            </MenuItem.Icon>
                                        </MenuItem>
                                    </ContextMenu>
                                </ListBox.ContextMenu>
                                <ListBox.ItemContainerStyle>
                                    <Style TargetType="ListBoxItem">
                                        <Setter Property="Padding" Value="5,2"/>
                                    </Style>
                                </ListBox.ItemContainerStyle>
                            </ListBox>
                        </StackPanel>

                        <Button Content="æ–°è¦Cycleç”¨ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ" Command="{Binding CreateNewCycleProfileCommand}"
                                Width="200" Margin="0,10,0,0" Padding="5"
                                Background="#4CAF50" Foreground="White" FontSize="11"/>
                    </StackPanel>
                </Border>
            </Grid>
        </GroupBox>

        <!-- ãƒ‡ãƒã‚¤ã‚¹è¨­å®šã‚¨ãƒªã‚¢ -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <GroupBox Header="ãƒ‡ãƒã‚¤ã‚¹é–‹å§‹ç•ªå·è¨­å®š" Padding="10">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- å·¦åˆ—: PLCç”¨ãƒ‡ãƒã‚¤ã‚¹ -->
                    <Border Grid.Column="0" BorderBrush="#2196F3" BorderThickness="2" Padding="10" Margin="0,0,5,0" CornerRadius="5">
                        <StackPanel>
                            <TextBlock Text="PLCç”¨ãƒ‡ãƒã‚¤ã‚¹ (PLCå…¨ä½“ã«1å›žé©ç”¨)" FontWeight="Bold" FontSize="14" Foreground="#2196F3" Margin="0,0,0,10"/>

                            <!-- ã‚·ãƒªãƒ³ãƒ€ãƒ‡ãƒã‚¤ã‚¹ -->
                            <Border BorderBrush="LightGray" BorderThickness="1" Padding="10" Margin="0,0,0,10">
                                <StackPanel>
                                    <TextBlock Text="ã‚·ãƒªãƒ³ãƒ€ãƒ‡ãƒã‚¤ã‚¹" FontWeight="Bold" FontSize="12" Margin="0,0,0,5"/>

                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Mãƒ‡ãƒã‚¤ã‚¹ [ã‚·ãƒªãƒ³ãƒ€]" Width="160"/>
                                        <TextBox Text="{Binding CylinderDeviceStartM}" Width="100"/>
                                        <CheckBox Content="ãƒ¡ãƒ¢ãƒªä¿å­˜" IsChecked="{Binding IsCylinderMemory}"/>
                                    </StackPanel>

                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Dãƒ‡ãƒã‚¤ã‚¹ [é€Ÿåº¦å¤‰åŒ–æŒ‡ä»¤]" Width="160"/>
                                        <TextBox Text="{Binding CylinderDeviceStartD}" Width="100"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>

                            <!-- ã‚¨ãƒ©ãƒ¼ãƒ‡ãƒã‚¤ã‚¹ -->
                            <Border BorderBrush="LightGray" BorderThickness="1" Padding="10" Margin="0,0,0,10">
                                <StackPanel>
                                    <TextBlock Text="ã‚¨ãƒ©ãƒ¼ãƒ‡ãƒã‚¤ã‚¹" FontWeight="Bold" FontSize="12" Margin="0,0,0,5"/>

                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Mãƒ‡ãƒã‚¤ã‚¹ [ã‚¨ãƒ©ãƒ¼]" Width="160"/>
                                        <TextBox Text="{Binding ErrorDeviceStartM}" Width="100"/>
                                        <CheckBox Content="ãƒ¡ãƒ¢ãƒªä¿å­˜" IsChecked="{Binding IsErrorMemory}"/>
                                    </StackPanel>

                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Tãƒ‡ãƒã‚¤ã‚¹ [ã‚¨ãƒ©ãƒ¼]" Width="160"/>
                                        <TextBox Text="{Binding ErrorDeviceStartT}" Width="100"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>

                            <!-- ã‚¿ã‚¤ãƒžãƒ¼ãƒ‡ãƒã‚¤ã‚¹ -->
                            <Border BorderBrush="LightGray" BorderThickness="1" Padding="10" Margin="0,0,0,10">
                                <StackPanel>
                                    <TextBlock Text="ã‚¿ã‚¤ãƒžãƒ¼ãƒ‡ãƒã‚¤ã‚¹" FontWeight="Bold" FontSize="12" Margin="0,0,0,5"/>

                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Tãƒ‡ãƒã‚¤ã‚¹ [ã‚¿ã‚¤ãƒž]" Width="160"/>
                                        <TextBox Text="{Binding DeviceStartT}" Width="100"/>
                                        <CheckBox Content="ãƒ¡ãƒ¢ãƒªä¿å­˜" IsChecked="{Binding IsTimerMemory}"/>
                                    </StackPanel>

                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="ZR [ã‚¿ã‚¤ãƒž]" Width="160"/>
                                        <TextBox Text="{Binding TimerStartZR}" Width="100"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>

                            <!-- å·¥ç¨‹æ™‚é–“ãƒ‡ãƒã‚¤ã‚¹ -->
                            <Border BorderBrush="LightGray" BorderThickness="1" Padding="10">
                                <StackPanel>
                                    <TextBlock Text="å·¥ç¨‹æ™‚é–“ãƒ‡ãƒã‚¤ã‚¹" FontWeight="Bold" FontSize="12" Margin="0,0,0,5"/>

                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="ZR [å·¥ç¨‹ã‚¿ã‚¤ãƒ ç¾åœ¨]" Width="160"/>
                                        <TextBox Text="{Binding ProsTimeStartZR}" Width="100"/>
                                        <CheckBox Content="ãƒ¡ãƒ¢ãƒªä¿å­˜" IsChecked="{Binding IsProsTimeMemory}"/>
                                    </StackPanel>

                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="ZR [å·¥ç¨‹ã‚¿ã‚¤ãƒ å‰å›ž]" Width="160"/>
                                        <TextBox Text="{Binding ProsTimePreviousStartZR}" Width="100"/>
                                    </StackPanel>

                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="ZR [CYã‚¿ã‚¤ãƒ ]" Width="160"/>
                                        <TextBox Text="{Binding CyTimeStartZR}" Width="100"/>
                                        <CheckBox Content="ãƒ¡ãƒ¢ãƒªä¿å­˜" IsChecked="{Binding IsCyTimeMemory}"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Border>

                    <!-- å³åˆ—: Cycleç”¨ãƒ‡ãƒã‚¤ã‚¹ -->
                    <Border Grid.Column="1" BorderBrush="#4CAF50" BorderThickness="2" Padding="10" Margin="5,0,0,0" CornerRadius="5">
                        <StackPanel>
                            <TextBlock Text="Cycleç”¨ãƒ‡ãƒã‚¤ã‚¹ (Cycleã”ã¨ã«é©ç”¨)" FontWeight="Bold" FontSize="14" Foreground="#4CAF50" Margin="0,0,0,10"/>

                            <!-- å·¥ç¨‹ãƒ‡ãƒã‚¤ã‚¹ -->
                            <Border BorderBrush="LightGray" BorderThickness="1" Padding="10" Margin="0,0,0,10">
                                <StackPanel>
                                    <TextBlock Text="å·¥ç¨‹ãƒ‡ãƒã‚¤ã‚¹" FontWeight="Bold" FontSize="12" Margin="0,0,0,5"/>

                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Lãƒ‡ãƒã‚¤ã‚¹ [å·¥ç¨‹]" Width="160"/>
                                        <TextBox Text="{Binding ProcessDeviceStartL}" Width="100"/>
                                        <CheckBox Content="ãƒ¡ãƒ¢ãƒªä¿å­˜" IsChecked="{Binding IsProcessMemory}"/>
                                    </StackPanel>

                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Lãƒ‡ãƒã‚¤ã‚¹ [å·¥ç¨‹è©³ç´°]" Width="160"/>
                                        <TextBox Text="{Binding DetailDeviceStartL}" Width="100"/>
                                        <CheckBox Content="ãƒ¡ãƒ¢ãƒªä¿å­˜" IsChecked="{Binding IsDetailMemory}"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>

                            <!-- æ“ä½œãƒ‡ãƒã‚¤ã‚¹ -->
                            <Border BorderBrush="LightGray" BorderThickness="1" Padding="10">
                                <StackPanel>
                                    <TextBlock Text="æ“ä½œãƒ‡ãƒã‚¤ã‚¹" FontWeight="Bold" FontSize="12" Margin="0,0,0,5"/>

                                    <StackPanel Orientation="Horizontal">
                                        <TextBlock Text="Mãƒ‡ãƒã‚¤ã‚¹ [æ“ä½œ]" Width="160"/>
                                        <TextBox Text="{Binding OperationDeviceStartM}" Width="100"/>
                                        <CheckBox Content="ãƒ¡ãƒ¢ãƒªä¿å­˜" IsChecked="{Binding IsOperationMemory}"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </Border>
                </Grid>
            </GroupBox>
        </ScrollViewer>

        <!-- å®Ÿè¡Œãƒœã‚¿ãƒ³ã‚¨ãƒªã‚¢ -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
            <Button Content="ãƒ¡ãƒ¢ãƒªè¨­å®šå®Ÿè¡Œ" Command="{Binding ExecuteMemorySettingCommand}"
                    Width="150" Height="35" Margin="0,0,10,0"
                    Background="#2196F3" Foreground="White" FontWeight="Bold" FontSize="14"/>
            <Button Content="é–‰ã˜ã‚‹" IsCancel="True"
                    Width="100" Height="35"
                    Padding="5"/>
        </StackPanel>

        <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,0,0,0">
            <TextBlock Text="ãƒ‡ãƒã‚¤ã‚¹æ•°:" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,5,0"/>
            <TextBlock Text="{Binding TotalMemoryDeviceCount}" VerticalAlignment="Center" Margin="0,0,10,0"/>
            <TextBlock Text="{Binding LastMemoryConfigTime}" VerticalAlignment="Center" Foreground="DarkGray" 
Visibility="{Binding IsMemoryConfigured, Converter={StaticResource BooleanToVisibilityConverter}}" Margin="0,0,10,0"/>

            <TextBlock Text="ãƒ¡ãƒ¢ãƒªè¨­å®šçŠ¶æ…‹:" FontWeight="Bold" VerticalAlignment="Center" Margin="0,0,10,0"/>

            <Border BorderBrush="{Binding IsMemoryConfigured, 
                        Converter={StaticResource BoolToColorConverter}, 
                        ConverterParameter='Green|Gray'}" BorderThickness="1" CornerRadius="3" Padding="5,2">
                <Border.Style>
                    <Style TargetType="Border">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsMemoryConfigured}" Value="True">
                                <Setter Property="Background" Value="#E6FFE6"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding IsMemoryConfigured}" Value="False">
                                <Setter Property="Background" Value="#F0F0F0"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Border.Style>
                <StackPanel Orientation="Horizontal">
                    <Ellipse Width="8" Height="8" Margin="0,0,5,0">
                        <Ellipse.Style>
                            <Style TargetType="Ellipse">
                                <Style.Triggers>
                                    <DataTrigger Binding="{Binding IsMemoryConfigured}" Value="True">
                                        <Setter Property="Fill" Value="Green"/>
                                    </DataTrigger>
                                    <DataTrigger Binding="{Binding IsMemoryConfigured}" Value="False">
                                        <Setter Property="Fill" Value="Gray"/>
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </Ellipse.Style>
                    </Ellipse>
                    <TextBlock Text="{Binding MemoryConfigurationStatus}" VerticalAlignment="Center"/>
                </StackPanel>

            </Border>
            <!-- ãƒ¡ãƒ¢ãƒªãƒ‡ãƒã‚¤ã‚¹ä¸€è¦§è¡¨ç¤ºãƒœã‚¿ãƒ³ -->
            <Button Command="{Binding ShowMemoryDeviceListCommand}" 
        IsEnabled="{Binding IsMemoryConfigured}"
        Padding="10,3" Margin="10,0,0,0">
                <Button.Style>
                    <Style TargetType="Button">
                        <Style.Triggers>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter Property="Opacity" Value="0.5"/>
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </Button.Style>
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="ðŸ“‹" FontSize="14" Margin="0,0,5,0"/>
                    <TextBlock Text="ä¸€è¦§è¡¨ç¤º" VerticalAlignment="Center"/>
                </StackPanel>
            </Button>
        </StackPanel>
    </Grid>
</Window>
