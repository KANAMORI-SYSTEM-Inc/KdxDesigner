<Window x:Class="KdxDesigner.Views.MemorySettingWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:KdxDesigner.Views"
        mc:Ignorable="d"
        Title="メモリ設定" Height="700" Width="900"
        WindowStartupLocation="CenterScreen">

    <Window.Resources>
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <Style TargetType="TextBox">
            <Setter Property="Margin" Value="5,2"/>
            <Setter Property="Padding" Value="3"/>
        </Style>
        <Style TargetType="CheckBox">
            <Setter Property="Margin" Value="10,2"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
        <Style TargetType="TextBlock">
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Margin" Value="5,2"/>
        </Style>
    </Window.Resources>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- プロファイル選択エリア -->
        <GroupBox Header="プロファイル選択" Grid.Row="0" Padding="10" Margin="0,0,0,10">
            <StackPanel>
                <!-- 既存プロファイル選択 -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,10" x:Name="ExistingProfilePanel">
                    <StackPanel.Style>
                        <Style TargetType="StackPanel">
                            <Setter Property="Visibility" Value="Visible"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsNewProfile}" Value="True">
                                    <Setter Property="Visibility" Value="Collapsed"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </StackPanel.Style>
                    <TextBlock Text="プロファイル:" Width="100" FontWeight="Bold"/>
                    <ComboBox ItemsSource="{Binding Profiles}"
                              SelectedItem="{Binding SelectedProfile}"
                              DisplayMemberPath="Name"
                              Width="300" Margin="5,0"/>
                    <Button Content="新規作成" Command="{Binding CreateNewProfileCommand}"
                            Width="100" Margin="10,0,0,0" Padding="5"/>
                    <TextBlock Text="{Binding SelectedProfile.Description}"
                               Margin="20,0,0,0"
                               FontStyle="Italic"
                               Foreground="Gray"/>
                </StackPanel>

                <!-- 新規プロファイル作成 -->
                <StackPanel x:Name="NewProfilePanel">
                    <StackPanel.Style>
                        <Style TargetType="StackPanel">
                            <Setter Property="Visibility" Value="Collapsed"/>
                            <Style.Triggers>
                                <DataTrigger Binding="{Binding IsNewProfile}" Value="True">
                                    <Setter Property="Visibility" Value="Visible"/>
                                </DataTrigger>
                            </Style.Triggers>
                        </Style>
                    </StackPanel.Style>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                        <TextBlock Text="プロファイル名:" Width="100" FontWeight="Bold"/>
                        <TextBox Text="{Binding NewProfileName, UpdateSourceTrigger=PropertyChanged}" Width="300"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                        <TextBlock Text="説明:" Width="100" FontWeight="Bold"/>
                        <TextBox Text="{Binding NewProfileDescription, UpdateSourceTrigger=PropertyChanged}" Width="300"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal">
                        <Button Content="保存" Command="{Binding SaveNewProfileCommand}"
                                Width="100" Margin="0,0,10,0" Padding="5"
                                Background="#4CAF50" Foreground="White" FontWeight="Bold"/>
                        <Button Content="キャンセル" Command="{Binding CancelNewProfileCommand}"
                                Width="100" Padding="5"/>
                    </StackPanel>
                </StackPanel>
            </StackPanel>
        </GroupBox>

        <!-- デバイス設定エリア -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <GroupBox Header="デバイス開始番号設定" Padding="10">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- 左列 -->
                    <StackPanel Grid.Column="0" Margin="0,0,10,0">
                        <!-- 工程デバイス -->
                        <Border BorderBrush="LightGray" BorderThickness="1" Padding="10" Margin="0,0,0,10">
                            <StackPanel>
                                <TextBlock Text="工程デバイス" FontWeight="Bold" FontSize="14" Margin="0,0,0,5"/>

                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Lデバイス [工程]" Width="180"/>
                                    <TextBox Text="{Binding ProcessDeviceStartL}" Width="100"/>
                                    <CheckBox Content="メモリ保存" IsChecked="{Binding IsProcessMemory}"/>
                                </StackPanel>

                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Lデバイス [工程詳細]" Width="180"/>
                                    <TextBox Text="{Binding DetailDeviceStartL}" Width="100"/>
                                    <CheckBox Content="メモリ保存" IsChecked="{Binding IsDetailMemory}"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>

                        <!-- 操作デバイス -->
                        <Border BorderBrush="LightGray" BorderThickness="1" Padding="10" Margin="0,0,0,10">
                            <StackPanel>
                                <TextBlock Text="操作・シリンダデバイス" FontWeight="Bold" FontSize="14" Margin="0,0,0,5"/>

                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Mデバイス [操作]" Width="180"/>
                                    <TextBox Text="{Binding OperationDeviceStartM}" Width="100"/>
                                    <CheckBox Content="メモリ保存" IsChecked="{Binding IsOperationMemory}"/>
                                </StackPanel>

                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Mデバイス [シリンダ]" Width="180"/>
                                    <TextBox Text="{Binding CylinderDeviceStartM}" Width="100"/>
                                    <CheckBox Content="メモリ保存" IsChecked="{Binding IsCylinderMemory}"/>
                                </StackPanel>

                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Dデバイス [速度変化指令]" Width="180"/>
                                    <TextBox Text="{Binding CylinderDeviceStartD}" Width="100"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>

                        <!-- エラーデバイス -->
                        <Border BorderBrush="LightGray" BorderThickness="1" Padding="10">
                            <StackPanel>
                                <TextBlock Text="エラーデバイス" FontWeight="Bold" FontSize="14" Margin="0,0,0,5"/>

                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Mデバイス [エラー]" Width="180"/>
                                    <TextBox Text="{Binding ErrorDeviceStartM}" Width="100"/>
                                    <CheckBox Content="メモリ保存" IsChecked="{Binding IsErrorMemory}"/>
                                </StackPanel>

                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Tデバイス [エラー]" Width="180"/>
                                    <TextBox Text="{Binding ErrorDeviceStartT}" Width="100"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </StackPanel>

                    <!-- 右列 -->
                    <StackPanel Grid.Column="1" Margin="10,0,0,0">
                        <!-- タイマーデバイス -->
                        <Border BorderBrush="LightGray" BorderThickness="1" Padding="10" Margin="0,0,0,10">
                            <StackPanel>
                                <TextBlock Text="タイマーデバイス" FontWeight="Bold" FontSize="14" Margin="0,0,0,5"/>

                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Tデバイス [タイマ]" Width="180"/>
                                    <TextBox Text="{Binding DeviceStartT}" Width="100"/>
                                    <CheckBox Content="メモリ保存" IsChecked="{Binding IsTimerMemory}"/>
                                </StackPanel>

                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ZR [タイマ]" Width="180"/>
                                    <TextBox Text="{Binding TimerStartZR}" Width="100"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>

                        <!-- 工程時間デバイス -->
                        <Border BorderBrush="LightGray" BorderThickness="1" Padding="10">
                            <StackPanel>
                                <TextBlock Text="工程時間デバイス" FontWeight="Bold" FontSize="14" Margin="0,0,0,5"/>

                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ZR [工程タイム現在]" Width="180"/>
                                    <TextBox Text="{Binding ProsTimeStartZR}" Width="100"/>
                                    <CheckBox Content="メモリ保存" IsChecked="{Binding IsProsTimeMemory}"/>
                                </StackPanel>

                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ZR [工程タイム前回]" Width="180"/>
                                    <TextBox Text="{Binding ProsTimePreviousStartZR}" Width="100"/>
                                </StackPanel>

                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="ZR [CYタイム]" Width="180"/>
                                    <TextBox Text="{Binding CyTimeStartZR}" Width="100"/>
                                    <CheckBox Content="メモリ保存" IsChecked="{Binding IsCyTimeMemory}"/>
                                </StackPanel>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Grid>
            </GroupBox>
        </ScrollViewer>

        <!-- 実行ボタンエリア -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
            <Button Content="メモリ設定実行" Command="{Binding ExecuteMemorySettingCommand}"
                    Width="150" Height="35" Margin="0,0,10,0"
                    Background="#2196F3" Foreground="White" FontWeight="Bold" FontSize="14"/>
            <Button Content="閉じる" IsCancel="True"
                    Width="100" Height="35"
                    Padding="5"/>
        </StackPanel>
    </Grid>
</Window>
